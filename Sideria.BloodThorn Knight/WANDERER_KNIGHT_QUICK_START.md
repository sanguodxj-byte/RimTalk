# 落魄骑士事件系统 - 快速开始指南

## ?? 快速开始

### 步骤1: 编译C#代码

#### 方法A: 使用批处理文件（推荐）

```bat
双击 Build.bat
```

该脚本会：
1. 检查RimWorld路径
2. 自动查找编译工具（dotnet 或 MSBuild）
3. 编译项目
4. 输出DLL到 `Assemblies/` 目录

#### 方法B: 手动编译

1. 打开 `Source/SideriaBloodThornKnight.csproj` 
2. 修改RimWorld引用路径
3. 使用Visual Studio或Rider编译

详见：`WANDERER_KNIGHT_EVENT_IMPLEMENTATION.md`

---

### 步骤2: 启动游戏测试

1. 确保 `Assemblies/SideriaBloodThornKnight.dll` 存在
2. 启动RimWorld
3. 在模组列表中启用本模组（确保HAR在前）
4. 开始新游戏或加载存档

---

## ?? 事件流程

### 第3天

希德莉亚会自动出现在殖民地边缘！

**初始状态：**
- 无武器
- 破旧装备
- 访客身份
- 不会自动离开

### 与希德莉亚互动

**右键点击希德莉亚**，会出现以下选项：

#### 选项1: 对话
了解她的故事和现状

#### 选项2: 给予食物
- 每天可以喂养一次
- 获得 +5 心情加成
- 累计喂养次数

#### 选项3: 给予传奇长剑
- 需要传奇品质的长剑
- **立即触发血之共鸣！**
- 长剑转化为阿茨冈德
- 生物编码绑定
- 希德莉亚力量觉醒
- 立即加入殖民地

### 30天后

如果你持续喂养希德莉亚（至少喂过1次）：
- 第33天（3+30）她会因感激而加入
- 虽然没有阿茨冈德，但仍是强大的战士

---

## ?? 测试检查清单

### 基础测试
- [ ] 第3天希德莉亚出现
- [ ] 收到"流浪骑士"信件
- [ ] 希德莉亚在地图边缘
- [ ] 右键显示互动菜单

### 喂养测试
- [ ] 可以给予食物
- [ ] 希德莉亚说"感谢"
- [ ] 获得 +5 心情
- [ ] 每天只计数一次

### 传奇剑测试
1. **准备传奇长剑**
   - 使用开发模式（F12）
   - 生成 → 传奇长剑
   
2. **测试转化**
   - [ ] 右键希德莉亚
   - [ ] 选择"给予传奇长剑"
   - [ ] 长剑消失
   - [ ] 阿茨冈德出现
   - [ ] 希德莉亚装备阿茨冈德
   - [ ] 武器生物编码
   - [ ] 希德莉亚加入殖民地

3. **验证觉醒**
   - [ ] 特质完整（4个）
   - [ ] 派系改为玩家

### 30天加入测试
1. **不给传奇剑**
   - 只喂养食物
   
2. **等待30天**
   - 使用开发模式加速时间
   
3. **验证加入**
   - [ ] 第33天收到信件
   - [ ] 希德莉亚加入殖民地
   - [ ] 保持原装备
   - [ ] 特质部分（2个）

---

## ?? 故障排查

### 问题1: 编译失败

**症状**: Build.bat报错或DLL未生成

**解决方法**:
1. 检查RimWorld路径是否正确
2. 确认安装了Visual Studio或.NET SDK
3. 手动使用Visual Studio打开项目编译

### 问题2: 第3天希德莉亚未出现

**症状**: 没有收到事件信件

**检查**:
1. 确认DLL正确加载（按~查看日志，搜索"Sideria"）
2. 确认有玩家主基地地图
3. 检查日志是否有错误

**临时解决**: 使用开发模式手动生成希德莉亚

### 问题3: 右键菜单不显示

**症状**: 右键希德莉亚没有特殊选项

**检查**:
1. 希德莉亚是否已加入（已加入则不显示）
2. Harmony补丁是否应用（查看日志）
3. 0Harmony.dll是否在Assemblies目录

### 问题4: 传奇剑不转化

**症状**: 给了传奇剑但没有转化

**检查**:
1. 确认是**传奇品质**（Legendary）
2. 确认是**长剑类**武器
3. 查看日志错误信息

---

## ?? 开发者日志

在游戏中按 `~` 打开控制台，查看模组日志：

```
[Sideria] BloodThorn Knight mod loaded successfully!
[Sideria] Triggering arrival event...
[Sideria] Sideria spawned at (x, y, z)
```

---

## ?? 自定义配置

### 修改触发天数

编辑 `Source/SideriaGameComponent.cs`:

```csharp
private const int EVENT_TRIGGER_DAY = 3;  // 改为5则第5天触发
```

### 修改感激加入天数

```csharp
private const int DAYS_FOR_GRATITUDE_JOIN = 30;  // 改为20则20天加入
```

修改后需要重新编译！

---

## ?? 相关文档

- `WANDERER_KNIGHT_EVENT_IMPLEMENTATION.md` - 完整技术文档
- `QUICK_REFERENCE.md` - 快速参考
- `README.md` - 模组总体介绍

---

## ? 享受游戏！

落魄骑士希德莉亚正在边缘世界等待你的帮助...

你会给她一个新的开始吗？ ???
