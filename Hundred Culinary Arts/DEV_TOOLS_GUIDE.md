# Living Weapons 开发工具使用说明

## ?? 测试工具功能

模组包含三个开发测试工具，用于快速测试活体武器的生成和概率机制：

### 1. 生成极差武器
- **功能**: 在地图中心生成一把随机的极差品质武器
- **用途**: 快速测试20%的活体武器生成概率
- **输出**: 会显示该武器是否成为活体武器

### 2. 测试概率 (100次)
- **功能**: 自动生成100把极差武器并统计活体武器出现率
- **用途**: 验证20%概率是否正常工作
- **输出**: 弹窗显示详细统计数据（实际概率 vs 预期概率）

### 3. 生成觉醒武器 Lv.5
- **功能**: 直接生成一把已觉醒的5级活体武器
- **用途**: 跳过培养过程，直接测试高等级武器效果

## ?? 使用方法

### 方法1: 通过游戏调试菜单（推荐）

1. **开启开发模式**
   - 游戏主菜单 -> Options -> Dev mode (勾选)
   - 或者游戏内按 `F11`

2. **打开调试动作菜单**
   - 游戏内按 `~`（波浪号键，在Esc下方）
   - 或点击顶部工具栏的 "Debug actions log"

3. **搜索并执行**
   - 在搜索框输入: `Living Weapons`
   - 选择你需要的测试功能
   - 点击执行

### 方法2: 通过控制台直接调用

1. **开启开发模式** (同上)

2. **打开代码控制台**
   - 按 `Ctrl + Shift + ~`

3. **输入代码**
   ```csharp
   // 生成极差武器
   LivingWeapons.LivingWeapons_DevTools.SpawnAwfulWeapon();
   
   // 测试概率
   LivingWeapons.LivingWeapons_DevTools.TestProbability();
   
   // 生成Lv.5觉醒武器
   LivingWeapons.LivingWeapons_DevTools.SpawnAwakenedWeaponLv5();
   ```

## ?? 测试结果解读

### 生成极差武器

成功示例：
```
? 生成潜伏活体武器: 极差 长剑
```

失败示例（正常）：
```
? 普通极差武器: 极差 短刀 (未触发20%概率)
```

### 概率测试

测试结果弹窗示例：
```
【极差武器概率测试】
武器类型: 长剑
━━━━━━━━━━━━━━━━
总测试数: 100
活体武器: 22
━━━━━━━━━━━━━━━━
实际概率: 22.0%
预期概率: 20.0%
偏差: +2.0%
```

**正常范围**: 由于随机性，实际概率在 15%-25% 之间都是正常的。
**异常情况**: 
- 如果实际概率长期低于10%或高于30%，可能存在问题
- 如果始终是0%，说明生成逻辑可能失败

## ?? 常见问题

### Q: 为什么找不到测试工具？
**A**: 确保：
1. 已开启开发模式（Dev Mode）
2. 已进入游戏存档（不是主菜单）
3. 正确搜索关键词 "Living Weapons"

### Q: 为什么点击"生成极差武器"没反应？
**A**: 检查：
1. 是否在地图视图中（不是世界地图）
2. 查看控制台日志（F12）是否有错误

### Q: 概率测试显示0%怎么办？
**A**: 这表示模组的Harmony补丁可能没有正常工作：
1. 检查是否安装了Harmony前置
2. 查看日志文件寻找错误信息
3. 尝试重启游戏

### Q: 生成的武器在哪里？
**A**: 所有武器都生成在当前地图的中心位置。如果找不到：
- 按 `Home`键快速居中视角
- 或者手动滚动到地图中央

## ?? 测试建议

### 快速功能验证
1. 先用"生成极差武器"测试3-5次，确认有武器能成为活体武器
2. 用"生成觉醒武器"测试高级功能（属性、技能等）
3. 最后用"测试概率"做全面验证

### 概率调试
如果你想修改概率进行测试：
1. 打开 `Source/LivingWeapons/LivingWeaponAttributes.cs`
2. 修改 `LWConstants` 中的概率常量
3. 重新编译并测试

```csharp
public const float AWFUL_SPAWN_CHANCE = 0.50f;  // 改为50%方便测试
```

## ?? 测试日志

所有测试操作都会在日志中留下记录，查看方法：
1. 游戏内按 `F12` 打开日志控制台
2. 搜索 `[Living Weapons]`
3. 查看详细的生成和测试信息

日志示例：
```
[Living Weapons] Spawned dormant living weapon: 极差 长剑
[Living Weapons] Starting probability test with 长剑...
[Living Weapons] Test results: 19/100 = 19.0% (expected 20.0%)
```

## ?? 测试检查清单

使用这个清单确保模组功能正常：

- [ ] 能生成极差武器
- [ ] 极差武器有20%左右概率成为活体武器
- [ ] 活体武器显示"潜伏经验"信息
- [ ] 能生成Lv.5觉醒武器
- [ ] 觉醒武器显示等级和属性信息
- [ ] 概率测试结果在合理范围（15%-25%）
- [ ] 装备武器后可以通过战斗获得经验

## ?? 反馈

如果测试中发现问题，请记录：
- 执行了什么操作
- 预期结果 vs 实际结果
- 相关的日志信息
- 游戏版本和模组版本

祝测试顺利！????
