# 厨间百艺 - 测试计划

## 测试目标

验证mod的所有核心功能正常工作，确保游戏体验流畅且无破坏性bug。

---

## 测试环境

### 基础环境
- **RimWorld版本**: 1.4 / 1.5
- **操作系统**: Windows 10/11
- **必需Mod**: Harmony

### 测试配置
1. **纯净测试**: 仅启用 Harmony + Culinary Arts
2. **兼容性测试**: 启用常见烹饪mod（VCE, Gastronomy等）
3. **DLC测试**: 分别测试 Royalty, Ideology, Biotech

---

## 功能测试清单

### 1. 基础功能测试

#### 1.1 Mod加载
- [ ] Mod能够正常加载，无错误日志
- [ ] Harmony补丁成功应用
- [ ] 初始化日志显示正确的技法/前缀/食材数量

**预期输出**:
```
[厨间百艺] Mod初始化成功！
[厨间百艺] 技法总数: 116
[厨间百艺] 前缀总数: 48
[厨间百艺] 食材映射: 13
```

#### 1.2 菜名生成
- [ ] 简单食物能够生成自定义名称
- [ ] 精致食物能够生成自定义名称
- [ ] 奢侈食物能够生成自定义名称
- [ ] 生存食品能够生成自定义名称

**测试方法**:
1. 让不同技能的厨师制作食物
2. 检查生成的菜名是否符合预期格式
3. 验证菜名包含技法和食材形态

---

### 2. 技能等级测试

#### 2.1 Tier 1: 生存本能 (0-5级)

**测试场景**: 新招募的难民（烹饪0-2级）

- [ ] 菜名使用Tier 1技法（煮、烤、乱炖等）
- [ ] 30%几率出现负面前缀
- [ ] 不会出现传说前缀
- [ ] 心情效果范围: -3 或 0 或 +3

**示例菜名**:
- ✓ "烧焦的煮肉块"
- ✓ "乱炖土豆"
- ✗ "绝世的佛跳墙"（不应出现）

#### 2.2 Tier 2: 烟火家常 (6-12级)

**测试场景**: 殖民地普通厨师（烹饪8-10级）

- [ ] 菜名使用Tier 2技法（红烧、清蒸、糖醋等）
- [ ] 10%几率负面，10%几率正面
- [ ] 不会出现传说前缀
- [ ] 心情效果范围: -3 或 0 或 +3

**示例菜名**:
- ✓ "红烧肉排配土豆丝"
- ✓ "美味的糖醋里脊"
- ✗ "发光的油封牛排"（不应出现）

#### 2.3 Tier 3: 珍馐美馔 (13-17级)

**测试场景**: 高级厨师（烹饪15级）

- [ ] 菜名使用Tier 3技法（慢煨、白灼、挂汁等）
- [ ] 无负面前缀
- [ ] 5%几率传说前缀
- [ ] 心情效果范围: 0 或 +3 或 +8

**示例菜名**:
- ✓ "主厨的慢煨狮子头"
- ✓ "完美的白灼海鲜"
- ✓ "绝世的挂汁牛排"（5%几率）

#### 2.4 Tier 4: 登峰造极 (18-20级)

**测试场景**: 传奇食神（烹饪20级）

- [ ] 菜名使用Tier 4技法（佛跳墙、满汉、Sous-vide等）
- [ ] 无负面前缀
- [ ] 20%几率传说前缀
- [ ] 心情效果范围: 0 或 +3 或 +8

**示例菜名**:
- ✓ "宫廷御膳烩饭"
- ✓ "发光的佛跳墙海鲜饭"
- ✓ "神级Sous-vide牛排配松露土豆慕斯"

---

### 3. 时间一致性测试

#### 3.1 6小时窗口内一致性

**测试步骤**:
1. 记录当前游戏时间
2. 让同一厨师用相同食材（如肉+土豆）制作5次食物
3. 检查5次产出的菜名是否完全相同

- [ ] 菜名100%一致
- [ ] 心情效果100%一致
- [ ] 风格（中/西式）100%一致

#### 3.2 跨窗口变化

**测试步骤**:
1. 制作食物，记录菜名
2. 使用开发者模式加速时间6小时
3. 用相同厨师和食材再次制作
4. 检查菜名是否改变

- [ ] 菜名应该不同（或有很小概率相同）
- [ ] 验证时间种子确实改变

---

### 4. 显示逻辑测试

#### 4.1 堆叠显示

**测试步骤**:
1. 制作20份相同食物
2. 观察仓库中的显示

- [ ] 仓库显示: "精致食物 x20"（原始名称）
- [ ] 不显示自定义菜名

#### 4.2 单品显示

**测试步骤**:
1. 从堆叠中取出1份
2. 选中单个食物
3. 观察名称

- [ ] 单品显示自定义菜名
- [ ] 检查栏显示完整信息

#### 4.3 持有/食用显示

**测试步骤**:
1. 小人拿起食物
2. 小人食用食物
3. 观察名称变化

- [ ] 小人持有时显示自定义名称
- [ ] 食用过程中显示自定义名称
- [ ] 食用完毕后消失

---

### 5. 心情效果测试

#### 5.1 负面效果 (-3)

**测试步骤**:
1. 让低技能厨师制作，等待负面前缀
2. 让小人食用
3. 检查心情栏

- [ ] 心情减少3点
- [ ] 显示"难以下咽的食物"
- [ ] 持续0.5天
- [ ] 可堆叠至3次

#### 5.2 正面效果 (+3)

**测试步骤**:
1. 让中高技能厨师制作，等待正面前缀
2. 让小人食用
3. 检查心情栏

- [ ] 心情增加3点
- [ ] 显示"美味的料理"
- [ ] 持续1天
- [ ] 可堆叠至5次

#### 5.3 传说效果 (+8)

**测试步骤**:
1. 让20级厨师制作多次，等待传说前缀
2. 让小人食用
3. 检查心情栏

- [ ] 心情增加8点
- [ ] 显示"绝世美食"
- [ ] 持续2天
- [ ] 只能有1次（不堆叠）

---

### 6. 中西风格测试

#### 6.1 中式菜名

**测试步骤**:
1. 制作多次食物，筛选中式风格
2. 验证命名规则

- [ ] 单食材: [前缀][技法][形态]  例: "红烧肉排"
- [ ] 多食材: [前缀][技法][主料]配[辅料]  例: "爆炒肉丝配土豆块"
- [ ] 使用中文技法词汇
- [ ] 使用中文食材形态

#### 6.2 西式菜名

**测试步骤**:
1. 制作多次食物，筛选西式风格
2. 验证命名规则

- [ ] 单食材: [Prefix] [Technique] [Form]  例: "Glazed Steak"
- [ ] 多食材: [Prefix] [Technique] [Main] with [Side]  例: "Sautéed Pork with Mashed Potato"
- [ ] 使用英文技法词汇
- [ ] 使用英文食材形态

---

### 7. 食材映射测试

测试所有已定义的食材映射是否正常工作。

#### 7.1 谷物类

- [ ] Rice (稻米) → 饭/粥/糕 或 Risotto/Paella
- [ ] Corn (玉米) → 窝头/糊 或 Polenta/Tortilla

#### 7.2 肉类

- [ ] Meat_Muffalo → 肉片/肉丝 或 Steak/Fillet
- [ ] Meat_Chicken → 鸡肉/鸡腿 或 Chicken Breast/Drumstick

#### 7.3 蔬菜类

- [ ] RawPotatoes → 土豆丝/土豆块 或 Mashed Potato/Fries

#### 7.4 未定义食材

**测试步骤**:
1. 使用mod添加的食材（如果有）
2. 检查是否回退到原始名称
3. 验证警告日志

- [ ] 使用原始DefName作为形态
- [ ] 日志输出警告信息
- [ ] 不会导致崩溃

---

### 8. 存档兼容性测试

#### 8.1 新存档

**测试步骤**:
1. 创建新游戏
2. 启用mod
3. 制作食物

- [ ] 食物正常生成自定义名称
- [ ] 无错误日志

#### 8.2 添加到现有存档

**测试步骤**:
1. 加载未启用mod的存档
2. 启用mod并重新加载
3. 制作新食物

- [ ] 新制作的食物有自定义名称
- [ ] 旧食物保持原名称
- [ ] 无错误或警告

#### 8.3 移除mod

**测试步骤**:
1. 加载启用mod的存档
2. 禁用mod并重新加载
3. 检查现有食物

- [ ] 食物恢复原始名称
- [ ] 自定义心情效果消失
- [ ] 无错误（可能有警告）
- [ ] 游戏可正常继续

---

### 9. 性能测试

#### 9.1 大量食物生成

**测试步骤**:
1. 使用开发者模式批量生成100份食物
2. 观察游戏性能

- [ ] FPS无明显下降
- [ ] 内存使用正常
- [ ] 无延迟或卡顿

#### 9.2 长期游戏测试

**测试步骤**:
1. 正常游戏3-5小时
2. 频繁制作和食用食物
3. 观察性能变化

- [ ] 无内存泄漏
- [ ] FPS保持稳定
- [ ] 无累积性能问题

---

### 10. 错误处理测试

#### 10.1 异常输入

**测试场景**:
- [ ] 无烹饪技能的小人（机器人）
- [ ] 无食材制作
- [ ] 特殊配方（如毒品制作）

**预期行为**:
- 不应崩溃
- 优雅降级（使用原始名称）
- 记录适当的警告日志

#### 10.2 Mod冲突

**测试场景**:
- [ ] 与VCE同时启用
- [ ] 与Gastronomy同时启用
- [ ] 与其他Harmony mod同时启用

**预期行为**:
- 无崩溃
- 功能正常或部分工作
- 清晰的冲突提示（如果有）

---

## 回归测试清单

每次更新后必须验证的核心功能：

1. [ ] Mod能正常加载
2. [ ] 食物能生成自定义名称
3. [ ] 技能等级影响菜品质量
4. [ ] 时间一致性正常工作
5. [ ] 堆叠显示逻辑正确
6. [ ] 心情效果正常触发
7. [ ] 存档兼容性无问题

---

## Bug报告模板

如果发现问题，请按以下格式记录：

```markdown
### Bug标题

**严重程度**: 低/中/高/崩溃性

**复现步骤**:
1. 
2. 
3. 

**预期行为**:


**实际行为**:


**环境信息**:
- RimWorld版本: 
- Mod版本: 
- 其他启用的mod: 

**错误日志**:
```
[粘贴相关日志]
```

**截图**:
[附加截图]
```

---

## 测试通过标准

- ✅ 所有核心功能测试通过
- ✅ 至少测试3个不同技能等级的厨师
- ✅ 存档兼容性测试通过
- ✅ 无崩溃性bug
- ✅ 性能影响 < 5%
- ✅ 至少一个兼容性mod测试通过

---

## 测试记录表

| 测试项 | 测试人 | 日期 | 结果 | 备注 |
|-------|--------|------|------|------|
| 基础功能 | | | | |
| 技能等级 | | | | |
| 时间一致性 | | | | |
| 显示逻辑 | | | | |
| 心情效果 | | | | |
| 存档兼容性 | | | | |
| 性能测试 | | | | |

---

**测试版本**: v1.0.0  
**最后更新**: 2025-12-26